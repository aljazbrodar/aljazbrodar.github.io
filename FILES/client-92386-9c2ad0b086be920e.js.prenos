"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[92386],{6764:(e,t,r)=>{r.d(t,{Z:()=>l});var i=r(72436),o=r(82386),d=r(47535),n=r(30330);const a=(0,i.zo)("div",{width:d.BW,height:"300px"}),l=()=>(0,n.tZ)(a,{children:(0,n.tZ)(o.Z,{})})},94348:(e,t,r)=>{r.d(t,{Z:()=>n});var i=r(6764),o=r(71104),d=r(30330);const n=()=>(0,d.tZ)(o.ZP,{children:(0,d.tZ)(i.Z,{})})},92386:(e,t,r)=>{r.d(t,{S:()=>je,Z:()=>qe});var i=r(18898),o=r(32912),d=r(38370),n=r(76448),a=r(63745),l=r(56182),s=r(25887),u=r(30778),p=r(72436),c=r(82673),g=r(68587),Z=r(45462),O=r(71104),h=r(37740),v=r(70536),m=r(56706),y=r(69851),S=r(30330);const f=(0,p.zo)("div",{width:"100%"}),U=(0,p.zo)("div",(e=>{let{$theme:t}=e;return t.typography.HeadingLarge})),k=()=>{const e=(0,o.TH)(),t=(0,o.UO)(),{inGroupOrderV2XP:r}=(0,m.Z)(),n=(0,d.gfM)(e,(0,d.WxO)(t)),a=(0,y.Z)({encodedStoreUuid:t.encodedStoreUuid}),{store:s,getStore:p}=(0,l.Z)(a),k=(0,u.I0)(),[C,L]=i.useState(!1),T=(0,v.Z)();return s.data&&C?(0,S.tZ)(o.l_,{to:(0,d.Ljk)(e,(0,d.WxO)(t))}):(0,S.tZ)(O.ZP,{backLocation:n,hasCloseButton:!1,hasBackButton:r,children:(0,S.BX)(O.HF,{children:[(0,S.tZ)(U,{children:(0,S.tZ)(c.v,{id:"component.location_typeahead_mobile.deliver_to"})}),(0,S.tZ)(h.ZP,{$height:24}),(0,S.tZ)(f,{children:(0,S.tZ)(Z.Z,{onLocationSelected:e=>{(e=>{e&&T(e)})(e),k((0,g.hW)()),L(!0),p()},initialQuery:"",id:"start-group-order"})})]})})};var C=r(73707),L=r(95427),T=r(38609);const B=e=>{const t=(0,T.i)(),r=(0,C.Z)();return(0,S.tZ)(O.ZP,{backLocation:t,hasBackButton:!0,onClose:()=>r(t),children:(0,S.tZ)(O.HF,{children:(0,S.tZ)(L.Z,{...e})})})};var D=r(9097);const b=e=>{const t=(0,T.i)(),r=(0,C.Z)(),i=()=>r(t);return(0,S.tZ)(O.ZP,{backLocation:t,hasBackButton:!0,onClose:i,children:(0,S.tZ)(O.HF,{children:(0,S.tZ)(D.Z,{repeatOrderOptions:e.repeatOrderOptions,onClose:i})})})};var P=r(91010),_=r(94348),x=r(14962),z=r(57894),M=r(99283),W=r(60496),I=r(49802),w=r(32259),A=r(35693),N=r(64064),R=r(40850),H=r(95937),E=r(92354),F=r(47535),X=r(74434),$=r(13702),Q=r(41899),G=r(27739),Y=r(19726),V=r(90029),j=r(23706),q=r(65887),K=r(93565),J=r(21888),ee=r(42269),te=r(71172),re=r(35077),ie=r(68223),oe=r(29482),de=r(15996),ne=r(43738),ae=r(17926),le=r(86087),se=r(5588),ue=r(89830),pe=r(15784),ce=r(60577),ge=r(30763),Ze=r(61271),Oe=r(19723),he=r(51916),ve=r(26049),me=r(66209),ye=r(9831);const Se=(0,p.zo)("div",{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"});function fe(e){const{onClick:t,isLoading:r,setShowUpdateNotification:i}=e,o=()=>{i(!1)};return(0,S.BX)(ye.Z,{closeModal:o,title:(0,S.tZ)(c.v,{id:"rgo.update.settings.notification.heading"}),children:[(0,S.tZ)(c.v,{id:"rgo.update.settings.notification.description"}),(0,S.tZ)(h.ZP,{$height:16}),(0,S.BX)(Se,{children:[(0,S.tZ)(me.zx,{isLoading:r,isFullWidth:!0,onClick:()=>t(),children:(0,S.tZ)(c.v,{id:"shared.got_it"})}),(0,S.tZ)(me.zx,{kind:me.TO.tertiary,isFullWidth:!0,onClick:()=>o(),children:(0,S.tZ)(c.v,{id:"shared.goBack"})})]})]})}var Ue=r(60262),ke=r(96262),Ce=r(88295),Le=r(61617),Te=r(32536),Be=r(42237),De=r(40261),be=r(32403),Pe=r(66692);const _e=(0,p.w1)(Q.f,{width:ue.f}),xe=(0,p.zo)("div",(e=>{let{$theme:t}=e;return t.typography.ParagraphMedium})),ze=(0,p.zo)("div",(e=>{let{$theme:t}=e;return{...t.typography.HeadingLarge,display:"flex",flexDirection:"row"}})),Me=(0,p.zo)("div",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphMedium,display:"inline"}})),We=e=>{var t,r,n,a,l,s,g,Z;const O=(0,o.TH)(),[,v]=(0,p.hQ)(),m=(0,o.UO)(),y=(0,E.T)(),f=(0,ke.Z)(),U=(0,Pe.Z)(),{errorSnackbar:k}=(0,Ue.Z)(),[L,T]=i.useState(!1),B=(0,le.ZP)(),D=(0,o.k6)(),b=(0,X.useQueryClient)(),[P,_]=i.useState(!1),{billSplitOption:x,groupSizeOption:M,repeatOrderOptions:W,groupOrderDeadlineTooltipConfig:w}=e,{deliveryLocation:A,diningMode:Q,deliveryTime:ue}=(0,I.Z)(e.storeUuid),ye=(0,d.gfM)(O,(0,d.WxO)(m)),{isRepeatGroupOrderEditing:Se}=(0,pe.Z)(),We=(0,C.Z)(),{createDraftOrderMaybe:Ie,createDraftOrder:we}=(0,j.Z)("group-order-desktop"),{checkoutOrder:Ae}=(0,ce.Z)(),{getBusinessDetails:Ne}=(0,z.IM)(),Re=(0,u.I0)(),{updateDraftOrderMaybe:He,updateDraftOrderMutation:{mutateAsync:Ee}}=(0,ge.Z)(),Fe=(0,J.v)((e=>{let{draftOrder:t}=e;return t.draftOrder})),Xe=(null==Fe||null===(t=Fe.data)||void 0===t?void 0:t.draftOrder)&&!(null!=Fe&&null!==(r=Fe.data)&&void 0!==r&&null!==(n=r.draftOrder)&&void 0!==n&&n.addParticipantsIntended)&&(null==Fe||null===(a=Fe.data)||void 0===a||null===(l=a.draftOrder)||void 0===l?void 0:l.storeUuid)===e.storeUuid,{draftOrderUuid:$e}=(0,re.Z)(),Qe=(0,te.Z)("getDraftOrderByUuidV2"),Ge=(0,te.Z)("getDraftOrdersByEaterUuidV1"),Ye=(0,ae.Z)(),Ve=Boolean(W),je=()=>{var t;return null!==(t=e.cartLockOptions)&&void 0!==t&&t.autoSubmit?(0,S.tZ)(c.v,{id:"shared.next"}):y(Se?"shared.save":P?W?"rgo.scheduling_repeat_order":"go.invite_people":W?"rgo.schedule_repeat_order":"go.invite_people")},qe=async()=>{_(!0);try{var t,r,i;if(Se){var o,n;if(await Ee({draftOrderUUID:null==m?void 0:m.repeatOrderTemplateUuid,billSplitOption:x,groupOrderArgs:{currencyCode:e.currencyCode,spendingLimit:e.spendingLimit},cartLockOptions:e.cartLockOptions,displayName:e.groupOrderName}),b.invalidateQueries([...he.H,null==m?void 0:m.repeatOrderTemplateUuid]),b.invalidateQueries((0,Oe.NK)(null==m?void 0:m.repeatOrderTemplateUuid)),_(!1),null!==(o=e.cartLockOptions)&&void 0!==o&&o.autoSubmit)D.push((0,d.gOA)(O,{cartLockOptions:e.cartLockOptions,repeatOrderTemplateUUID:null!==(n=null==m?void 0:m.repeatOrderTemplateUuid)&&void 0!==n?n:""}));else We();return}B("eats:group_order_create_click",{isBillSplitOrder:x===ne.x.SPLIT_BY_SUBTOTAL,hasSpendingLimit:Boolean(e.spendingLimit),isAutoSubmitOrder:Boolean(null===(t=e.cartLockOptions)||void 0===t?void 0:t.autoSubmit),hasDeadline:Boolean(e.cartLockOptions),isScheduledOrder:!0===ue.scheduled,hhcoGroupSizeSelection:{groupSizeSelected:null==M?void 0:M.hhcOrderSize}});const y=!(null===(r=e.cartLockOptions)||void 0===r?void 0:r.autoSubmit)||Ve?e.cartLockOptions:null;let S=null;if(Xe&&$e&&!Ve){var a,l,s,u,p,c,g,Z,h;await Ee({draftOrderUUID:$e,businessDetails:null==Fe||null===(a=Fe.data)||void 0===a?void 0:a.draftOrder.businessDetails,billSplitOption:(null==Fe||null===(l=Fe.data)||void 0===l||null===(s=l.draftOrder)||void 0===s?void 0:s.billSplitOption)!==x?x:void 0,groupOrderArgs:{currencyCode:e.currencyCode,spendingLimit:e.spendingLimit},deliveryAddress:(0,ie.Er)(A,null==Fe||null===(u=Fe.data)||void 0===u||null===(p=u.draftOrder)||void 0===p?void 0:p.deliveryAddress)?void 0:A,targetDeliveryTimeRange:(0,oe.O)(ue,null==Fe||null===(c=Fe.data)||void 0===c||null===(g=c.draftOrder)||void 0===g?void 0:g.targetDeliveryTimeRange)?void 0:ue,diningMode:Q!==(null==Fe||null===(Z=Fe.data)||void 0===Z||null===(h=Z.draftOrder)||void 0===h?void 0:h.diningMode)?Q:void 0,cartLockOptions:y,displayName:e.groupOrderName,handledHighCapacityOrderMetadata:(0,se.Qe)(null==M?void 0:M.hhcOrderSize),...W?{repeatSchedule:(0,Ze.OL)({repeatOrderOptions:W})}:{}}),S=$e,Ve||Qe({draftOrderUUID:$e})}else{const{draftOrder:t}=await we({shoppingCartItems:[],isBandwagon:!1,groupOrderStoreUUID:e.storeUuid,spendingLimit:e.spendingLimit,currencyCode:e.currencyCode,businessDetails:Ne(),billSplitOption:x,addParticipantsIntended:!0,displayName:e.groupOrderName,cartLockOptions:y,deliveryTime:ue,promotionUuid:e.promotionUuid||"",handledHighCapacityOrderMetadata:(0,se.Qe)(null==M?void 0:M.hhcOrderSize),repeatOrderOptions:W});S=t.uuid,Re((0,ee.op)(t)),Ve||Ye&&Ge({})}if(_(!1),Ve){var v;const t=null==W?void 0:W.firstOrderScheduledForDate,r=null==W?void 0:W.endsOnDate;B("eats:repeat_order_create",{repeatOrder:{startDate:t?(0,ve.Wp)(t):"",endDate:r?(0,ve.Wp)(r):"",frequency:null==W?void 0:W.frequency,submissionType:null!==(v=e.cartLockOptions)&&void 0!==v&&v.autoSubmit?"auto":"manual"}})}if(null!==(i=e.cartLockOptions)&&void 0!==i&&i.autoSubmit)return void D.replace((0,d.gOA)(O,{cartLockOptions:e.cartLockOptions}));Ve?(await Ae(S),D.replace((0,d.Wf2)(O,S))):D.replace((0,d.iTI)(O,(0,d.WxO)(m)))}catch(e){_(!1),k({message:y("components.genericError.title")})}},Ke=()=>(0,S.tZ)(Te.Z,{returnFocus:!0,autoFocus:!0,placement:Be.r4.left,content:()=>(0,S.tZ)(De.Z,{width:"356px",children:(0,S.tZ)(be.Yl,{color:v.colors.primaryB,children:(0,S.tZ)(c.v,{id:"go.help.content.group.order.setup.description"})})}),children:(0,S.tZ)(De.Z,{marginRight:"16px",children:(0,S.tZ)(Le.Z,{size:22})})});let Je=(0,S.BX)(S.HY,{children:[U?null:(0,S.tZ)(K.Z,{}),(0,S.tZ)(de.Z,{isMobile:!1,storeTitle:e.storeTitle,storeUuid:e.storeUuid,spendingLimit:e.spendingLimit,currencyCode:e.currencyCode,groupOrderName:e.groupOrderName,cartLockOptions:e.cartLockOptions,billSplitOption:x,repeatOrderOptions:W,groupSizeOption:M,groupOrderDeadlineTooltipConfig:w}),(0,S.tZ)(R.Z,{"data-test":"group-order-modal-primary-button",disabled:Ie.isLoading||He.isLoading||!A||P,onClick:()=>{Se?T(!0):qe()},children:je()})]});function et(){We(ye)}return e.isWithinDeliveryRange||(Je=(0,S.BX)(S.HY,{children:[(0,S.tZ)(ze,{children:(0,S.tZ)(c.v,{id:"go.restaurant_too_far_away"})}),(0,S.tZ)(h.ZP,{$height:8}),(0,S.tZ)(xe,{children:(0,S.tZ)(c.v,{id:"go.restaurant_too_far_away_description"})}),(0,S.tZ)(h.ZP,{$height:24}),(0,S.tZ)(R.Z,{$as:N.rU,to:(0,d.dat)(O),children:(0,S.tZ)(c.v,{id:"shared.viewRestaurants"})})]})),(0,S.tZ)(S.HY,{children:L?(0,S.tZ)(fe,{isLoading:P,setShowUpdateNotification:T,onClick:qe}):(0,S.tZ)(H.ZP,{zIndex:F.I_.modal,children:(0,S.BX)($.u_,{"aria-label":je(),size:G.NO.auto,animate:!1,overrides:{DialogContainer:{style:{alignItems:"flex-start"}},Dialog:{style:{marginTop:"80px"}}},onClose:et,children:[Ie.error?(0,S.tZ)(q.c,{children:(0,S.tZ)(Me,{children:(null===(s=Ie.error.meta)||void 0===s||null===(g=s.alert)||void 0===g||null===(Z=g.body)||void 0===Z?void 0:Z.text)||Ie.error.message})}):null,(0,S.tZ)(Y.xB,{floatingMode:U?Y.rY.floating:Y.rY.floatingOnceScrolled,leftButton:(0,S.tZ)(V.hQ,{kind:U?me.TO.secondary:me.TO.monochromatic,onClick:et}),...f?{rightButton:(0,S.tZ)(Ke,{})}:{},title:je()}),U?(0,S.tZ)(Ce.Z,{}):null,(0,S.tZ)(_e,{children:Je})]})})})};var Ie=r(28723),we=r(17960),Ae=r(49622),Ne=r(8123),Re=r(76691);function He(e){const t=(0,o.k6)(),r=()=>t.goBack(),[,i]=(0,p.hQ)();return(0,S.BX)(ye.Z,{title:(0,S.tZ)(c.v,{id:"rgo.store_hours.title"}),headerProps:{leftButton:(0,S.tZ)(V.ay,{onClick:r})},children:[(0,S.tZ)("div",{style:{padding:"".concat(i.sizing.scale800," 0"),marginBottom:i.sizing.scale600},children:(0,S.tZ)(Ne.t,{store:e.store})}),(0,S.tZ)(Re.V,{onClick:r,children:(0,S.tZ)(c.v,{id:"shared.goBack"})})]})}var Ee=r(4231);const Fe=()=>(0,S.tZ)(we.wT,{children:(0,S.tZ)(ye.Z,{closeable:!1,title:(0,S.tZ)(c.v,{id:"ro.delete_title"}),children:(0,S.tZ)(Ee.Z,{})})});var Xe=r(89018),$e=r(5142),Qe=r(74279),Ge=r(24707),Ye=r(65879);const Ve=Ge.CI.GROUP_ORDER_CREATE,je=e=>{var t,r,u;const[p,c]=i.useState(!1),g=(0,o.TH)(),Z=(0,o.UO)(),O=(0,C.Z)(),{storeUuid:h,repeatOrderOptions:v,setRepeatOrderOptions:m,isRepeatGroupOrderEditing:f,deadlineOptions:U,groupSizeOption:L,setStoreUuid:T,cartLockOptions:D,setCartLockOptions:z,groupOrderDeadlineTooltipConfig:N}=(0,Xe.Dy)(),R=(0,he.Z)(null==Z?void 0:Z.repeatOrderTemplateUuid),H=null==R||null===(t=R.query)||void 0===t?void 0:t.isSuccess,E=(0,d.gfM)(g,(0,d.WxO)(Z)),{user:F}=(0,n.Z)(),{store:X,shouldGetStore:$,getStore:Q}=(0,l.Z)(h),G=null===(r=F.data)||void 0===r?void 0:r.firstName,Y=null===(u=F.data)||void 0===u?void 0:u.isLoggedIn,V=(0,A.Z)(),[j,q]=(0,Ae.UH)(),[K,J]=(0,Ae.Ej)(),[ee,te]=(0,Ae.xB)(),re=(0,W.Z)("pm_go"),{deliveryTime:ie}=(0,I.Z)(h),oe=(0,y.Z)({encodedStoreUuid:Z.encodedStoreUuid});(0,a.Z)((()=>$?Q():null),[$,Q],"store-desktop-start-group-order"),i.useEffect((()=>{!f&&(oe&&oe!==h)&&T(oe)}),[h,T,oe,f]),i.useEffect((()=>{f&&H&&!p&&(z(null==R?void 0:R.cartLockOptions),m(null==R?void 0:R.repeatOrderOptions),T(null==R?void 0:R.storeUuid),q(null==R?void 0:R.spendingLimit),J(null==R?void 0:R.billSplitOption),te(null==R?void 0:R.displayName),c(!0))}),[H,R,f,p,m,z,T,q,J,te]),i.useEffect((()=>{const e=(0,$e.GI)({deadlineOptions:U,cartLockOptions:D,repeatOrderOptions:v,deliveryTime:ie,groupSizeOption:L});Boolean(e)&&!f&&z(e)}),[U,v,f,ie,D,L,z]);const{hhcoDeliveryTimeModalSurfaced:de,onDismissTimepicker:ne,onDeliveryTimeUpdate:ae}=(0,Qe.Z)({entryPoint:Ve,storeUuid:h,showSnackbarOnUpdate:!0});return Y&&(G||F.isLoading)&&re?(0,S.tZ)(x.Z,{error:()=>(0,S.tZ)(M.Z,{}),loading:()=>(0,S.tZ)(_.Z,{}),source:(0,Ye.FP)(X,F),loaded:e=>{let[t,r]=e;return(0,S.BX)(o.rs,{children:[(0,S.tZ)(o.AW,{exact:!0,path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/edit-name","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/edit-name"],render:()=>(0,S.tZ)(B,{groupOrderName:ee,setGroupOrderName:te})}),(0,S.tZ)(o.AW,{exact:!0,path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/edit-deadline","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/edit-deadline"],render:()=>(0,S.tZ)(b,{repeatOrderOptions:v})}),(0,S.tZ)(o.AW,{exact:!0,path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/repeat-group-order","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/repeat-group-order"],render:()=>(0,S.tZ)(w.i,{repeatOrderOptions:v,setRepeatOrderOptions:m,store:t,isMobile:!1})}),(0,S.tZ)(o.AW,{path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/store-hours","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/store-hours"],render:()=>(0,S.tZ)(He,{store:t})}),(0,S.tZ)(o.AW,{exact:!0,path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/edit-spending-limit","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/edit-spending-limit"],render:()=>(0,S.tZ)(s.Z,{spendingLimit:j,setSpendingLimit:q,billSplitOption:K,setBillSplitOption:J,isMobile:!1})}),(0,S.tZ)(o.AW,{path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/edit-delivery-address","/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/edit-delivery-address"],component:k}),(0,S.tZ)(o.AW,{path:["/:languageCountryPair?/repeat-order/:repeatOrderTemplateUuid/edit-rgo-settings/delete"],component:Fe}),(0,S.tZ)(o.AW,{exact:!0,path:"/:languageCountryPair?/store/:storeSlug/:encodedStoreUuid/:sectionUuid?/start-group-order/edit-group-size",render:()=>{var e;return(0,S.tZ)(P.Z,{groupOrderSizes:(null==X||null===(e=X.data)||void 0===e?void 0:e.groupOrderSizes)||[]})}}),(0,S.tZ)(o.AW,{children:de?(0,S.tZ)(Ie.Z,{onClose:ne,onDeliveryTimeUpdate:e=>ae(e),storeUuid:h,entryPoint:Ve}):(0,S.tZ)(We,{storeTitle:t.title,isWithinDeliveryRange:t.isWithinDeliveryRange,storeUuid:t.uuid,spendingLimit:j,currencyCode:t.currencyCode,groupOrderName:ee,cartLockOptions:D,billSplitOption:K,repeatOrderOptions:v,promotionUuid:t.suggestedPromotion.promotionUuid,groupSizeOption:V?L:null,groupOrderDeadlineTooltipConfig:N})})]})}}):(f&&O(),(0,S.tZ)(o.l_,{to:E}))},qe=()=>(0,S.tZ)(z.ZP,{children:(0,S.tZ)(we.wT,{children:(0,S.tZ)(Xe.Mo,{children:(0,S.tZ)(je,{})})})})},9831:(e,t,r)=>{r.d(t,{Z:()=>v});var i=r(45528),o=r(95937),d=r(73707),n=r(38370),a=r(90029),l=r(13702),s=r(27739),u=r(19726),p=r(41899),c=r(25301),g=r(47535),Z=r(89830),O=r(30330);const h=e=>{const t=(0,i.T)(),r=(0,d.Z)(),{title:h,children:v,headerProps:m,closeModal:y=(()=>r((0,n.C45)(t))),closeable:S=!0}=e,f={leftButton:(0,O.tZ)(a.hQ,{onClick:y}),...m};return(0,O.tZ)(o.ZP,{zIndex:g.I_.modal,children:(0,O.BX)(l.u_,{size:s.NO.auto,animate:!1,onClose:y,closeable:S,overrides:{DialogContainer:{style:{alignItems:"flex-start"}},Dialog:{style:{marginTop:"80px"}}},children:[(0,O.tZ)(u.xB,{...f}),(0,O.BX)(p.f,{$style:{width:Z.f},$removeMarginTop:!0,children:[h?(0,O.tZ)(c.r,{children:h}):null,v]})]})})};h.displayName="RepeatGroupOrderDesktopModal";const v=h}}]);