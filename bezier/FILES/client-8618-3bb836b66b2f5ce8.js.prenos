"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[8618],{89539:(e,r,t)=>{t.d(r,{Z:()=>n});var o=t(72436),i=t(44912),a=t(43712);const n=(0,o.zo)("button",(e=>({...(0,i.Z)({$theme:e.$theme,radius:e.radius}),textAlign:"center",color:e.$theme.colors.negative,...e.disabled?(0,a.Z)(e.$theme):{}})))},94964:(e,r,t)=>{t.d(r,{Z:()=>l});var o=t(40850),i=t(64064),a=t(43571),n=t(38306),d=t(30330);function l(e){const r=e.button||o.Z,t=(0,a.Z)(e.source),l=(0,n.Z)();return(0,d.tZ)(r,{$as:i.rU,to:l,onClick:()=>{t(),e.onClick&&e.onClick()},children:e.children})}},8618:(e,r,t)=>{t.d(r,{Vk:()=>Q,ZP:()=>G,RA:()=>z});var o=t(82673),i=t(32912),a=t(21888),n=t(30778),d=t(42269),l=t(37740),s=t(30330);function c(e){return e.error&&"string"==typeof e.error.message?e.error.message:(0,s.tZ)(o.v,{id:"shared.genericServerError"})}var u=t(94964),v=t(72436),p=t(38306),m=t(57894),_=t(8629),Z=t(89539),h=t(40850),y=t(38370),f=t(43571),g=t(96648),C=t(4878),T=t(235),E=t(5830),O=t(77808),k=t(62216),R=t(94034),b=t(41495);var A=t(18898),D=t(86087),P=t(34684);const I=()=>{var e;const r=(0,D.ZP)(),{serverCart:t}=(0,C.iQ)(),o=(null===(e=t.data)||void 0===e?void 0:e.items)||[],i=(0,P.dH)(o),{data:a,error:n}=t;A.useEffect((()=>{var e;"DRAFT_ORDER_VALIDATION_ERROR"===(null==n||null===(e=n.meta)||void 0===e?void 0:e.type)&&r("eats:draft_order_validation_error",{quantity:i,storeUuid:null==a?void 0:a.storeUuid,draftOrderUuid:null==a?void 0:a.draftOrderUuid,cartUuid:null==a?void 0:a.cartUuid})}),[n,a,i,r])};var U=t(33135),N=t(57722),M=t(96699),S=t(83778),L=t(93011),H=t(83735);const B=(0,v.zo)("div",(e=>{let{$theme:r}=e;return{...r.typography.HeadingMedium,display:"flex",marginBottom:"8px"}})),$=(0,v.zo)("div",(e=>{let{$theme:r}=e;return r.typography.ParagraphMedium})),w=(0,v.zo)("div",{marginTop:"24px",display:"flex",alignItems:"center",flexDirection:"column"});function x(e){if(!e)return null;switch(e.type){case"recustomizeParams":var r;return null===(r=e.recustomizeParams)||void 0===r?void 0:r.itemsToRecustomize;case"removeParams":var t;return null===(t=e.removeParams)||void 0===t?void 0:t.itemsToRemove;default:return null}}function z(e){var r;const t=(0,i.TH)(),o=function(){var e;const r=(0,R.Z)(),{deliveryInstructions:t}=(0,O.useContext)(k.X),{upsertDeliveryLocationWithInstruction:o}=(0,b.Z)(),i=(0,n.I0)();return(0,O.useCallback)((async e=>{var a,n,l,s;if(!r)return;const c=(null===(a=t.data)||void 0===a?void 0:a.instructions)||[];let u=c.find((r=>r.interactionType===e));"leave_at_door"!==e||u||(u=c.find((e=>"door_to_door"===e.interactionType))),await o({instruction:{aptOrSuite:(null===(n=u)||void 0===n?void 0:n.aptOrSuite)||"",notes:(null===(l=u)||void 0===l?void 0:l.notes)||"",businessName:(null===(s=u)||void 0===s?void 0:s.businessName)||"",interactionType:e},nickName:r.label||"",location:r}),await i((0,d.Dr)(e))}),[null===(e=t.data)||void 0===e?void 0:e.instructions,r,o])}(),{paymentProfiles:l}=(0,m.IM)(),s=(0,_.Z)(),c=(0,f.Z)("order_estimate_error"),u=(0,p.Z)(),v=(0,i.k6)(),{updateDraftOrder:Z}=(0,C.A4)(),h=(0,T.Z)(),{restaurantLink:g}=(0,E.Z)(),{serverCart:A}=(0,C.iQ)(),P=(0,n.I0)(),I=(null===(r=A.data)||void 0===r?void 0:r.items.length)||0,N=(0,U.Z)(),{openSidebarCart:B}=(0,M.Lb)(),{isMobile:$}=(0,a.v)((e=>{let{device:r}=e;return r})),w=(0,S.pv)(),z=(0,D.ZP)(),Q=(0,H.Z)().storeUUID;return async r=>{switch(r.type){case"RECUSTOMIZE":{const e=x(r.params);if(e){const[r]=e;v.replace((0,y.vN_)(t,"editItem",r))}else v.replace((0,y.C45)(t));return}case"REMOVE_ITEMS":{const e=x(r.params);z("eats:checkout_error_remove_items"),e&&s({shoppingCartItemUUIDs:e});const o=(e||[]).length,i=I-o==0;return void(N&&e&&i||v.replace((0,y.C45)(t)))}case"CLEAR_CART":return c(),void v.replace(u);case"RETRY_ESTIMATE":return Z({forceUpdate:!0}),void v.replace((0,y.C45)(t));case"SWITCH_PAYMENT":{const e=l&&l.length>0?(0,y.vN_)(t,"paymentsSelectProfile"):(0,y.vN_)(t,"paymentsAddProfile");return void v.replace(e)}case"ADD_PAYMENT":return void v.replace((0,y.vN_)(t,"paymentsAddProfile"));case"SWITCH_TO_DOOR_TO_DOOR":return P((0,d.J4)()),w(),await o("door_to_door"),void v.replace((0,y.C45)(t));case"SWITCH_TO_LEAVE_AT_DOOR":return P((0,d.J4)()),w(),await o("leave_at_door"),void v.replace((0,y.C45)(t));case"VIEW_CARTS":if(h(),$){const r=e?(0,y._UC)(e):(0,y.C45)(t);v.replace((0,y.nQQ)(r))}else v.replace((0,y.C45)(t)),B();return;case"NONE":return h(),z("eats:checkout_error_dismiss"),void(e?v.replace(e):v.replace((0,y.C45)(t)));case"GO_TO_MENU":return void v.replace(g);case"CLEAR_CART_AND_REDIRECT_TO_FEED":return c(),void v.replace(u);case"SCHEDULE_ORDER":return void v.replace((0,L.t)(t,{storeUuid:Q,entryPoint:"checkout"}))}}}function Q(){return(0,s.BX)(s.HY,{children:[(0,s.tZ)(B,{children:(0,s.tZ)(o.v,{id:"components.genericError.title"})}),(0,s.tZ)($,{children:(0,s.tZ)(c,{error:null})}),(0,s.tZ)(l.ZP,{$height:24}),(0,s.tZ)(u.Z,{source:"order_estimate_error",children:(0,s.tZ)(o.v,{id:"shared.clearCart"})})]})}function G(e){const r=e.originUrl,t=e.validationError.alert,o=z(r),i=null==t?void 0:t.primaryButton,a=null==t?void 0:t.secondaryButton;if(I(),!t||!i)return(0,s.tZ)(Q,{});let n="";t.bodyBadges?n=t.bodyBadges.map(((e,r)=>(0,s.tZ)(N.ZP,{badge:e},r))):t.body&&(n=(0,s.tZ)(g.Z,{badge:t.body,baseFont:"ParagraphMedium"}));let d="";var l;"string"==typeof t.title?d=t.title:d=null===(l=t.title)||void 0===l?void 0:l.text;return(0,s.BX)(s.HY,{children:[d?(0,s.tZ)(B,{children:d}):null,(0,s.tZ)($,{children:n}),(0,s.BX)(w,{children:[(0,s.tZ)(h.Z,{onClick:()=>{o(i)},children:i.title}),a?(0,s.tZ)(Z.Z,{onClick:()=>{o(a)},children:a.title}):null]})]})}},5830:(e,r,t)=>{t.d(r,{Z:()=>g});var o=t(77808),i=t(92354),a=t(81327),n=t(30370),d=t(38370),l=t(72436),s=t(45528),c=t(56182),u=t(4878),v=t(35077),p=t(56706),m=t(17926),_=t(13222),Z=t(86087),h=t(96699),y=t(33135),f=t(30330);function g(e){var r,t;const{isDraftOrderCreator:g,isDraftOrderParticipant:C,creatorName:T,hasGroupOrder:E,orderDisplayName:O,isEditOrder:k,deliveryAddress:R,deliveryTime:b,diningMode:A}=(0,v.Z)(),D=(0,i.T)(),[P]=(0,l.hQ)(),{serverCart:I}=(0,u.iQ)(),U=(0,s.T)(),{store:N,shouldGetStore:M,getStore:S}=(0,c.Z)((null===(r=I.data)||void 0===r?void 0:r.storeUuid)||(null==e?void 0:e.storeUuid)),[,L]=(0,l.hQ)(),{inGroupOrderV2XP:H}=(0,p.Z)(),B=(0,m.Z)(),$=(0,_.Z)(),w=(0,Z.ZP)(),{closeSidebarCart:x}=(0,h.Lb)(),z=(0,y.Z)();o.useEffect((()=>{M&&S()}),[S,M]);const Q=E&&H&&O||k&&D("go.edit_group_order")||g&&D("go.your_group_order")||C&&D("go.group_order_title",{firstName:T})||D("components.CheckoutOrderMarketplaceHeader.yourOrder"),G=(null===(t=N.data)||void 0===t?void 0:t.title)||"",V=(0,f.tZ)("span",{className:P({...B?L.typography.LabelMedium:L.typography.LabelSmall,...(0,a.lE)({$theme:L}),color:L.colors.action}),children:G});return{title:Q,storeTitle:G,restaurantLink:N.data?(0,d.gfM)(U,(0,d.Btk)(N.data)):"",restaurantLinkNode:(0,n.P)(D("go.cart_store_name"),{storeName:V}),onGoToStore:o.useCallback((()=>{B&&($(),S({deliveryAddress:R,deliveryTime:b,diningMode:A,isGroupOrderParticipant:C})),w("eats:click_store_link",{source:z?"checkout":"cart",...B&&{activePreferenceType:"draft_order"}}),x()}),[B,w,z,x,$,S,R,b,A,C])}}},235:(e,r,t)=>{t.d(r,{Z:()=>u});var o=t(30778),i=t(42269),a=t(69822),n=t(70536),d=t(17926),l=t(33163),s=t(35077),c=t(83778);function u(){const e=(0,a.g)(),r=(0,n.Z)(),t=(0,o.I0)(),u=(0,d.Z)(),{deliveryTime:v,deliveryAddress:p,diningMode:m,storeUuid:_}=(0,s.Z)(),Z=(0,c.pv)();return()=>{t((0,i.J4)()),Z(),u?t((0,l.A0)(_,{...v?{storeScheduledTime:v}:{},...p?{storeDeliveryLocation:p}:{},...m?{storeDiningMode:m}:{}})):(p&&r(p,null),m&&e(m))}}}}]);